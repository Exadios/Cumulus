<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<!-- $Id$ -->
<html>
<head>
  <title>Cumulus Maps</title>
  <link rel="stylesheet" type="text/css" href="text.css">
</head>

<body>

<table width="100%">
  <tbody>
    <tr>
      <td align="left"><a href="cumulus-gettingstarted.html">back</a></td>
      <td align="center"><a href="cumulus.html">start</a></td>
      <td align="right"><a href="cumulus-settings.html">next</a></td>
    </tr>
  </tbody>
</table>

<h3 align="center">Maps</h3>

<p>Cumulus uses the following sets of maps:</p>

<ul>
  <li><b>Ground and Terrain Maps</b> with streets, highways, cities, rivers, lakes, ... and
      terrain data with elevation information. They cover the entire world and you should
      download only the part which you need for your flying. Goto the
      <a href="http://www.kflog.org/maproom/ground-and-terrain-data">Map Room</a>,
      make a selection and install the downloaded map files in the expected directory.
  </li>

  <li><b>Airspaces:</b> Cumulus does only support the OpenAir file format for airspace structures.
      Please search in the Internet for files of the region where you do fly.
      Adresses where you can find information maybe:
      <ul>
        <li><a href="http://soaringweb.org/SUA/">soaringweb.org/SUA</a>
        <li><a href="http://www.daec.de/aul/luftr_d.php">Airspace Data Germany</a> published by the DAeC
      </ul>
  </li>

  <li><b>Airports, Airfields and Outlanding Points:</b> These data are read from the
      Welt2000 data base. See <a href="#Welt2000">here</a> for more information.
  </li>
</ul>

<p>The maps can be installed at two different places:</p>

<ul>
  <li>In <b>$HOME/cumulus/maps</b> (Desktop) or in <b>$HOME/MyDocs/Cumulus/maps</b>
      (Maemo). These are the default locations.</li>

  <li>Anywhere else, e.g. on a SD card. Under Maemo (Nokia Internet Tablet)
      it is recommended to change to this location because the internal
      memory is limited and not accessible via USB from the outside.</li>
</ul>

<p><b>Please Note! The map files have to be stored in different subdirectories
under the root map path.</b>
</p>

<ul>

  <li>The ground and terrain data files have to be put into a subdirectory called <i>landscape</i>.
  </li>

  <li>The airfield files have to be put into a subdirectory called <i>airfields</i>.
  </li>

  <li>The airspace files have to be put into a subdirectory called <i>airspaces</i>.
  </li>

</ul>

<p>You must create these subdirectories alone under the map root.</p>

<p>
If the maps are installed outside of the known locations, e.g. on a SD card
at your Internet Tablet, you must setup the path to the new map root directory
in the Map Settings configuration page
(Setup-&gt;General Setup-&gt;Map Setting). Use the <i>Maps</i>
button to navigate to the appropriate root directory under which the expected
maps subdirectories are to find. Is nothing is setup the maps are searched
only under the default location. But this directory is unsuitably for the
Nokia Internet Tablet due to no access via an USB connection and the limited
space at the home file system.
</p>

<p>
Do only load the airfields and do install the airspace maps for the area you need.
This will make Cumulus faster and saves runtime memory. The Ground and Terrain Maps
maps are not concerned of that.
If you experience memory problems running Cumulus, you can
choose not to install certain map sets. You could for instance skip the
terrain maps. This will disable the display of terrain features (the
isolines) but it will also save memory and reduce map loading and
drawing time. It is advisable at least to use the Ground maps because
you will end up with a blue background otherwise, which is not very
helpful in navigation. </p>

<p>The maps you install are not projected. This is done on
loading. Because this is a computationally complex operation, the
resulting maps are stored again with a <i>.kfc or .txc</i>
extension. For many maps, these files are a bit smaller than the
original files. The next time Cumulus needs to load the file, it first
tries to load this <i>compiled</i> file to improve speed.
In the <a href="cumulus-settings-map-settings.html">
Map Settings</a>&nbsp;page you can modify the behaviour of
Cumulus for map projection and map compilation.</p>

<p><b>OpenAir SUA map files</b></p>

<p>Cumulus supports the commonly available OpenAir SUA file
format for airspaces. Just put the map files in the subdirectory <i>airspaces</i>
and make sure they have the <i>.txt</i> extension written
in <b>lower</b> letters. </p>

<p>In addition to the OpenAir files themselves, you can add a
file to configure the mapping of airspace types from the OpenAir file
to the types Cumulus uses. Cumulus knows the following types: </p>

<ul>
  <li>AirA
  <li>AirB
  <li>AirC
  <li>AirD
  <li>AirE
  <li>AirF
  <li>ControlC
  <li>ControlD
  <li>Danger
  <li>Restricted
  <li>LowFlight
  <li>Tmz
  <li>GliderSector
  <li>WaveWindow
</ul>

In order to create a mapping file, create a file with the same basename
as the OpenAir file (without the <i>.txt</i> extension)
and append <i>_mappings.conf</i> to the basename.
<p>Example: Sourcefile=<i>openair.txt</i>,
Mappingfile=<i>openair_mappings.conf</i></p>

<p>The mapping file must be placed in the same directory as the
OpenAir file is contained. The used syntax in the file is simple. Empty
lines and lines starting with <i>#</i> or <i>*</i>
are ignored and can be used for comments. The rest of the lines should
contain entries in the form <i>key = value</i>, one entry
per line. The key is the airspace type in the OpenAir file you wish to
map and the value is the corresponding Cumulus type you wish to assign.
The default mappings are:</p>

<ul>
  <li>A = AirA
  <li>B = AirB
  <li>C = AirC
  <li>D = AirD
  <li>E = AirE
  <li>F = AirF
  <li>GP = Restricted
  <li>R = Restricted
  <li>TRA = Restricted
  <li>Q = Danger
  <li>CTR = ControlC
  <li>TMZ = Tmz
  <li>GSEC = GliderSector
  <li>W = WaveWindow
</ul>

<p>You only need to define the values you actually want to change
in the file. These instructions will overwrite the default mappings. </p>

<p>Example: <i>CTR=ControlD</i></p>

<p>This statement changes the assignment <i>ControlC</i>
to <i>ControlD</i>.
</p>

<p><b>Consider that the mappings are
case sensitive!</b></p>

<a name="Welt2000"></a>
<p><b>Usage of Welt2000 airfield and outlanding data</b></p>

<p>Cumulus uses for airfields and outlandings the Welt2000 data base. These data
were created by Michael Meier, called Milomei, as one big file
<a href="http://www.segelflug.de/vereine/welt2000/download/WELT2000.TXT">here.</a>
</p>

<p>Just install this file in the subdirectory <i>airfields</i>
and make sure that it carries the name <i>welt2000.txt</i>.
Because a welt2000.txt file covers the whole world, the amount of data
to be read in must be limited in a useful kind. Cumulus provides for
that two ways:</p>

<ul>

  <li> Filtering by countries or radius around your home position to be
      defined under the configuration setup of Airfields.
      See <a href="cumulus-settings-airfields.html#Welt2000Filter">
      Airfields</a> for more information. </li>

  <li> Filtering by countries to be defined in a configuration
      file with the name <i>welt2000.conf</i>. See below how to
      do that. That is an old option and should not more used. Please make
      your filter definitions via the cumulus GUI as described above. <b>Note!</b>
      A filter rule setup via the GUI will overwrite the rules defined in the
      configuration file.
  </li>

</ul>

<p>One disadvantage of Welt2000 is that it knows only three
types of airfield elements (Airfield, Glider Field, Ultra Light Field)
but cumulus a lot more. This lack can be overcome by an additional
provided mapping. You can map short names or ICAO identifiers of the
Welt2000 file entries into other cumulus map elements by using a
simple syntax to be defined in a configuration file. The configuration
file has to carry the name <i>welt2000.conf</i> and must
be located in the same directory where the source file <i>welt2000.txt</i>
is to find. The file provides the following syntax: </p>

<ul>

  <li> A comment line starts with a <i>#</i>
hashmark or a <i>$</i> dollar sign and ends with the
newline. </li>

  <li><b>FILTER countries=</b><i>country_1[,...,country_n]</i>
    <br>

This line defines a country filter rule. Several countries can be
entered after the equal sign in one line as list separated by commas.
The country identifiers have to be coded according to ISO-3166. If such
rule is defined, only the listed countries will be extracted from the
Welt2000 source file. That should be the common way to get the desired
subset of airfield data from the whole source. It is possible to define
more than one filter rule. </li>

  <li><b>MAP_SHORT_NAME</b> <i>short-name</i>=<i>map-element-of-cumulus</i>
    <br>

This line defines a rule for mapping of a short name (first six left
standing characters) of a Welt2000 entry at a special cumulus map
element. </li>

  <li><b>MAP_ICAO</b> <i>icao-sign</i>=<i>map-element-of-cumulus</i>
    <br>

This line defines a rule for mapping of an ICAO identifier of a Welt2000
entry at a special cumulus map element. </li>

</ul>

The supported cumulus map elements for airfields are:
<ul>

  <li>IntAirport </li>

  <li>Airport </li>

  <li>MilAirport </li>

  <li>CivMilAirport </li>

  <li>Airfield </li>

  <li>ClosedAirfield </li>

  <li>CivHeliport </li>

  <li>MilHeliport </li>

  <li>AmbHeliport </li>

  <li>Glidersite </li>

  <li>UltraLight </li>

  <li>HangGlider </li>

</ul>

<b>Consider that the cumulus map elements used in mapping rules
are case sensitive.</b>
<p>Short example of a welt2000.conf file: </p>

<p># Example of a welt2000.conf file, starting with a comment
line <br>

$ This is also a comment line <br>

# <br>

# Now follows a country filter definition rule <br>

# Only the coutries Germany, Poland and Czechia will be extracted from
the welt2000.txt source <br>

FILTER countries=de,pl,cz <br>

# <br>

# Now follows an ICAO identifier mapping rule <br>

# The german airport Berlin-Sch&ouml;nefeld is mapped at an
international airport element <br>

MAP_ICAO EDDB=IntAirport <br>

# <br>

# Now follows a short name mapping rule <br>

# The german military airport Holzdorf is mapped at a military airport
element <br>

MAP_SHORT_NAME HOLZD1=MilAirport </p>

<p><b>Please note the following!</b> If a new
welt2000.txt file has been installed the first run of cumulus after
that needs a longer time (ca. 10-20 seconds) to extract the desired
data from it. Cumulus generates a compressed file of the extracted data
reuseable by further runs of it. This file carry the name <i>welt2000.txc</i>
and will be reused, so long the original source, the configuration
file, the map projection or the home position are not changed. This
behavior minimize the read in time after a restart. </p>

<p>If you make necessary corrections on the data of the Welt2000
file, please report all your changes to the guys, who do
maintain the source. Their email address is to find in the header part
of the Welt2000 file or
<a href="http://www.segelflug.de/vereine/welt2000/">at this page.</a>
We all should help to keep up to date the Welt2000 source and thanks the guys
who do this work.
</p>

<p>
<table width="100%">
  <tbody>
    <tr>
      <td align="left"><a href="cumulus-gettingstarted.html">back</a></td>
      <td align="center"><a href="cumulus.html">start</a></td>
      <td align="right"><a href="cumulus-settings.html">next</a></td>
    </tr>
  </tbody>
</table>
</p>

</body>
</html>
